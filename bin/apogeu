#!/usr/bin/env node

const yargs = require('yargs');

const argv = yargs
  .help('h')
  .alias('help', 'h')
  .version()
  .alias('version', 'v')
  .option('start', {
    alias: 's',
    describe: 'Start project',
  })
  .option('new', {
    alias: 'n',
    describe: 'New project',
  })
  .option('create', {
    alias: 'c',
    describe: 'Create model structure',
  })
  .option('debug', {
    alias: 'd',
    describe: 'Execute command in debug mode',
  })
  .wrap(yargs.terminalWidth())
  .argv;

const required = ['start', 'new', 'create'];
let showHelp = true;

required.forEach((field) => {
  if (showHelp) showHelp = !argv[field];
});

if (showHelp) {
  yargs.showHelp();
  process.exit(1);
}

require('../src/bluebird');

if (argv.debug) process.env.DEBUG = 'apogeu:*';
const debug = require('debug')('apogeu:apogeu');

debug('init apogeu');

if (argv.start) require('./www');
if (argv.new) require('./new')(argv.new === true ? undefined : argv.new);
if (argv.create) require('./create')(argv.create);
