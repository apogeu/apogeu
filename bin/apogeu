#!/usr/bin/env node

const yargs = require('yargs');

const defaultOptions = {
  debug: {
    alias: 'd',
    describe: 'Execute command in debug mode',
    default: false,
  },
};

const argv = yargs
  .help('h')
  .alias('help', 'h')
  .version()
  .alias('version', 'v')
  .command('start', 'Start project', defaultOptions)
  .command('new <project_name>', 'New project', defaultOptions)
  .command('create <modelName>', 'Create model structure', defaultOptions)
  .demandCommand(1, 'You need at least one command before moving on')
  .argv;

if (argv.debug) process.env.DEBUG = 'apogeu:*';
const debug = require('debug')('apogeu:apogeu');

debug('init apogeu');

require('../src/bluebird');

const command = argv._[0];

debug(`command: ${command}`);

switch (command) {
  case 'start':
    require('./www');
    break;
  case 'new':
    require('./new')(argv.project_name);
    break;
  case 'create':
    require('./create')(argv.modelName);
    break;
  default:
    yargs.showHelp();
    process.exit(1);
    break;
}
